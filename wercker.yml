box:
  id: ymotongpoo/hugo

build:
  steps:
    - script:
        name: checkout source branch and build site with hugo.
        cwd: $WERCKER_SOURCE_DIR
        code: |
          git checkout source
          git submodule init
          git submodule update
          /home/hugo/hugo --theme=tropic
    - script:
        name: copy all content to output directory.
        cwd: $WERCKER_SOURCE_DIR
        code: |
          cp -r public/. $WERCKER_OUTPUT_DIR

deploy:
  steps:
    - script:
        name: copy all content to master branch.
        cwd: $WERCKER_SOURCE_DIR
        code: |
          git checkout master
          cp -rf $WERCKER_OUTPUT_DIR/. . 
          git add --all
          git commmit -m '[wercker] `date +"%Y%m%d%H%M%S"`'
          git push origin master
